# Password cracking

An amazing index of brute-force commands

```text
https://book.hacktricks.xyz/brute-force
```

## Hydra <a id="hydra"></a>

* MD5 32 hex characters.
* SHA-1 40 hex characters.
* SHA-256 64 hex characters.
* SHA-512 128 hex characters.
* * Find hash type at https://hashkiller.co.uk
* Running john will tell you the hash type even if you don't want to crack it:
* Paste the entire /etc/shadow in file and run
* Paste the entire /etc/shadow in file and run
* GPU cracking:

  ```text
  hashcat -m 500 -a 0 -o output.txt -remove hashes.txt /usr/share/wordlists/rockyou.txt
  ```

* CPU cracking:

  ```text
  john --wordlist=/usr/share/wordlists/rockyou.txt 127.0.0.1.pwdump
  ```

* Cracking **/etc/shadow**:

  ```text
  unshadow /etc/passwd /etc/shadow /tmp/combined; john --wordlist=<any word list> /tmp/combined
  ```

* Generating wordlists

  ```text
  crunch 6 6 0123456789ABCDEF 5o crunch1.txt
  ```

* Online rainbow tables:

  ```text
  https://crackstation.net/http://www.cmd5.org/http://crackhash.com/https://hashkiller.co.uk/md5-decrypter.aspxhttps://www.onlinehashcrack.com/http://rainbowtables.it64.com/http://www.md5online.org/
  ```

## Hashcat-Cheatsheet <a id="hashcat-cheatsheet"></a>

Hashcat Cheatsheet for OSCP [https://hashcat.net/wiki/doku.php?id=hashcat](https://hashcat.net/wiki/doku.php?id=hashcat)​

### Identify Hashes <a id="identify-hashes"></a>

`hash-identifier`

Example Hashes: [https://hashcat.net/wiki/doku.php?id=example\_hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)​

### MAX POWER! <a id="max-power"></a>

I have found that I can squeeze some more power out of my hash cracking by adding these parameters:

```text
--force -O -w 4 --opencl-device-types 1,2
```

These will force Hashcat to use the CUDA GPU interface which is buggy but provides more performance \(–force\) , will Optimize for 32 characters or less passwords \(-O\) and will set the workload to "Insane" \(-w 4\) which is supposed to make your computer effectively unusable during the cracking process. Finally "--opencl-device-types 1,2 " will force HashCat to use BOTH the GPU and the CPU to handle the cracking.

### Using hashcat and a dictionary <a id="using-hashcat-and-a-dictionary"></a>

Create a .hash file with all the hashes you want to crack puthasheshere.hash: $1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/

Hashcat example cracking Linux md5crypt passwords $1$ using rockyou:

`hashcat --force -m 500 -a 0 -o found1.txt --remove puthasheshere.hash /usr/share/wordlists/rockyou.txt`

Hashcat example cracking Wordpress passwords using rockyou: `hashcat --force -m 400 -a 0 -o found1.txt --remove wphash.hash /usr/share/wordlists/rockyou.txt`

Sample Hashes [http://openwall.info/wiki/john/sample-hashes](http://openwall.info/wiki/john/sample-hashes)​

### HashCat One Rule to Rule them All <a id="hashcat-one-rule-to-rule-them-all"></a>

Not So Secure has built a custom rule that I have had luck with in the past: [https://www.notsosecure.com/one-rule-to-rule-them-all/](https://www.notsosecure.com/one-rule-to-rule-them-all/) The rule can be downloaded from their Github site: [https://github.com/NotSoSecure/password\_cracking\_rules](https://github.com/NotSoSecure/password_cracking_rules)​

I typically drop OneRuleToRuleThemAll.rule into the rules subfolder and run it like this from my windows box \(based on the notsosecure article\):

```text
hashcat64.exe --force -m300 --status -w3 -o found.txt --remove --potfile-disable -r rules\OneRuleToRuleThemAll.rule hash.txt rockyou.txt
```

### Using hashcat bruteforcing <a id="using-hashcat-bruteforcing"></a>

```text
predefined charsets?l = abcdefghijklmnopqrstuvwxyz?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ?d = 0123456789?s = «space»!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~?a = ?l?u?d?s?b = 0x00 - 0xff
```

?l?d?u is the same as: ?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789

Brute force all passwords length 1-8 with possible characters A-Z a-z 0-9 `hashcat64 -m 500 hashes.txt -a 3 ?1?1?1?1?1?1?1?1 --increment -1 ?l?d?u`

### Cracking Linux Hashes - /etc/shadow file <a id="cracking-linux-hashes-etc-shadow-file"></a>

### Cracking Windows Hashes <a id="cracking-windows-hashes"></a>

### Cracking Common Application Hashes <a id="cracking-common-application-hashes"></a>

### Cracking Common File Password Protections <a id="cracking-common-file-password-protections"></a>

### Cracking Commmon Database Hash Formats <a id="cracking-commmon-database-hash-formats"></a>

### Cracking NTLM hashes <a id="cracking-ntlm-hashes"></a>

After grabbing or dumping the NTDS.dit and SYSTEM registry hive or dumping LSASS memory from a Windows box, you will often end up with NTLM hashes.

And using Impacket to dump the hashes

```text
impacket-secretsdump -system SYSTEM -ntds ntds.dit -hashes lmhash:nthash LOCAL -outputfile ntlm-extract
```

You can crack the NTLM hash dump usign the following hashcat syntax:

```text
hashcat64 -m 1000 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\hashsample.hash "d:\WORDLISTS\realuniq.lst" -r OneRuleToRuleThemAll.rule
```

_Benchmark using a Nvidia 2060 GTX:_ Speed: 7000 MH/s Recovery Rate: 12.47% Elapsed Time: 2 Hours 35 Minutes

### Cracking Hashes from Kerboroasting - KRB5TGS <a id="cracking-hashes-from-kerboroasting-krb-5-tgs"></a>

A service principal name \(SPN\) is a unique identifier of a service instance. SPNs are used by Kerberos authentication to associate a service instance with a service logon account. This allows a client application to request that the service authenticate an account even if the client does not have the account name. KRB5TGS - Kerberoasting Service Accounts that use SPN Once you have identified a Kerberoastable service account \(Bloodhound? Powershell Empire? - likely a MS SQL Server Service Account\), any AD user can request a krb5tgs hash from it which can be used to crack the password.

Based on my benchmarking, KRB5TGS cracking is 28 times slower than NTLM.

Hashcat supports multiple versions of the KRB5TGS hash which can easily be identified by the number between the dollar signs in the hash itself.

* 13100 - Type 23 - $krb5tgs$23$
* 19600 - Type 17 - $krb5tgs$17$
* 19700 - Type 18 - $krb5tgs$18$

KRB5TGS Type 23 - Crackstation humans only word list with OneRuleToRuleThemAll mutations rule list.

```text
hashcat64 -m 13100 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\krb5tgs.hash d:\WORDLISTS\realhuman_phill.txt -r OneRuleToRuleThemAll.rule	
```

_Benchmark using a Nvidia 2060 GTX:_ Speed: 250 MH/s Elapsed Time: 9 Minutes

### To crack linux hashes you must first unshadow them <a id="to-crack-linux-hashes-you-must-first-unshadow-them"></a>

`unshadow passwd-file.txt shadow-file.txt`

`unshadow passwd-file.txt shadow-file.txt > unshadowed.txt`

### Crack a zip password <a id="crack-a-zip-password"></a>

`zip2john Zipfile.zip | cut -d ':' -f 2 > hashes.txt` `hashcat -a 0 -m 13600 hashes.txt /usr/share/wordlists/rockyou.txt`

Hashcat appears to have issues with some zip hash formats generated from zip2john. You can fix this by editing the zip hash contents to align with the example zip hash format found on the hash cat example page: `$zip2$*0*3*0*b5d2b7bf57ad5e86a55c400509c672bd*d218*0**ca3d736d03a34165cfa9*$/zip2$`

John seems to accept a wider range of zip formats for cracking.

